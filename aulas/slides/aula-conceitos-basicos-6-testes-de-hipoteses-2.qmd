---
title: "RevisÃ£o de conceitos bÃ¡sicos"
subtitle: "Testes de hipÃ³teses"
author: "Dr. Alexandre Dias Kassuga"
format:
  revealjs:
    theme: simple
    css: 
      - slides.css
      - footer.css
    highlight-style: monokai
    slide-number: true
    format: wide
---

## Testes de significÃ¢ncia para uma amostra


- Finalidade
  - Testar se a mÃ©dia populacional de uma variÃ¡vel de interesse Ã© igual a determinado valor especificado pelo pesquisador

\

- CondiÃ§Ãµes:
  - VariÃ¡veis quantitativas contÃ­nuas
  - Tamanho da amostra
    - Pequena (n<30) â€“ Teste t Student
      - Dados com distribuiÃ§Ã£o normal
    - Grande (n>30) â€“ Teste Z
      - NÃ£o hÃ¡ restriÃ§Ã£o quanto a normalidade (TCL)


::: {.absolute top="400" right="50"}

$$
Z = \frac{\bar{X} - \mu_0}{\frac{\sigma}{\sqrt{n}}}
$$

:::

## Teste T

:::: {.columns}

::: {.column width="50%"}

- William Sealy Gosset 
  - (13 de Junho de 1876 â€“ 16 de Outubro de 1937)
  - Trabalhou como estatÃ­stico na Guinness
  - Karl Pearson
    - RegressÃ£o linear
    - ClassificaÃ§Ã£o de distribuiÃ§Ãµes
    - Chi-quadrado de Pearson
    - Coeficiente de correlaÃ§Ã£o
    - CENTENAS DE DADOS
  - MÃ©todo para pequenas amostras
  - NÃ£o era permitido publicar trabalhando na Guinness
    - â€œStudentâ€



:::

::: {.column width="50%"}

![](figuras/gosset-guinness.png){width="100%"}

:::

::::


## Teste T

![](figuras/gosset-guinness2.png){width="60%"}


## Testes de significÃ¢ncia para uma amostra

:::: {.columns}

::: {.column width="50%"}

- Etapas:
  - H0: Fixar o valor Âµ0 da mÃ©dia Âµ a ser testado - Âµ = Âµ0.
  - H1: Escolher hipÃ³tese alternativa:
    (a) Âµ < Âµ0
    (b) Âµ > Âµ0
    (c) Âµ â‰  Âµ0
  - Determinar o valor crÃ­tico:
    - Para pequenas amostras
      - tÎ±/2 ou tÎ± (teste unilateral), com v = n-1 g.l.
  - Para grandes amostras
      - z Î±/2  ou tÎ± (teste unilateral)

:::

::: {.column width="50%"}

\
\

$$
Z = \frac{\bar{x}-\mu_0}{\frac{\sigma}{\sqrt{n}}}
$$
\
\
\

$$
t = \frac{\bar{x}-\mu_0}{\frac{s}{\sqrt{n}}}
$$

:::

::::


## Testes de significÃ¢ncia para uma amostra

:::: {.columns}

::: {.column width="50%"}

- Etapas:
  - H0: Fixar o valor Âµ0 da mÃ©dia Âµ a ser testado - Âµ = Âµ0.
  - H1: Escolher hipÃ³tese alternativa:
    (a) Âµ < Âµ0
    (b) Âµ > Âµ0
    (c) Âµ â‰  Âµ0
  - Determinar o valor crÃ­tico:
    - Para pequenas amostras
      - tÎ±/2 ou tÎ± (teste unilateral), com v = n-1 g.l.
  - Para grandes amostras
      - z Î±/2  ou tÎ± (teste unilateral)

:::

::: {.column width="50%"}

\
\

$$
Z = \frac{\bar{x}-\mu_0}{\frac{\sigma}{\sqrt{n}}}
$$
\
\
\

$$
t = \frac{\bar{x}-\mu_0}{\frac{s}{\sqrt{n}}}
$$

:::

::::

::: {.absolute top="110" left="610"}

![](figuras/placa-media-amostral.png){width="45%"}

:::

::: {.absolute top="115" left="835"}

![](figuras/placa-media-testada.png){width="100%"}

:::

::: {.absolute top="205" left="805"}

![](figuras/placa-desvio-pop.png){width="100%"}

:::

::: {.absolute top="225" left="670"}

![](figuras/placa-n.png){width="50%"}

:::

::: {.absolute top="455" left="805"}

![](figuras/placa-desvio-amostral.png){width="100%"}

:::

## Testes de significÃ¢ncia para uma amostra

- Etapas:
  - Tomada de decisÃ£o
    - Compara-se o valor zÎ± ou t Î± com o calculado
    - Com base no valor de p
    - p < Î± â€“ Rejeita hipÃ³tese nula


::: texto-65

```{r}

# Tabela t de Student - valores crÃ­ticos

# Graus de liberdade
nu <- 1:10

# Probabilidades (colunas da tabela)
p <- c(0.6, 0.7, 0.8, 0.9, 0.95, 0.975, 0.98, 0.99, 0.995)

# Criar data frame base
tabela_t <- data.frame(
  `Î½` = nu
)

# Calcular quantis da t
for (prob in p) {
  tabela_t[[as.character(prob)]] <- qt(prob, df = nu)
}

# Arredondar (padrÃ£o de livro)
tabela_t[ , -1] <- round(tabela_t[ , -1], 3)

# Exibir tabela
knitr::kable(
  tabela_t,
  caption = "Tabela t de Student â€“ Valores crÃ­ticos",
  align = "c"
)


```

:::

## Testes de significÃ¢ncia para uma amostra

:::: {.columns}

::: {.column width="60%"}

- Qui quadrado ($\chi^2$)
  - Finalidade
    - Verificar se a distribuiÃ§Ã£o de frequÃªncias absolutas observadas na amostra difere da distribuiÃ§Ã£o esperada
  - CondiÃ§Ãµes
    - VariÃ¡veis qualitativas
      - Nominais
      - Ordinais
    - Se 2 categorias â€“ frequÃªncia > 5
    - Se 3+ categorias 
      - menos de 20% das frequÃªncias <5
      - Todas >1
      
:::

::: {.column width="40%"}

\
\
\
\
\
\

$$
\chi^2 = \sum_{i=1}^{k} \frac{(O_i - E_i)^2}{E_i}
$$

:::

::::

## Testes de significÃ¢ncia para duas amostras

- Teste t para duas amostras independentes
  - Finalidade
    - Verificar a diferenÃ§a entre as mÃ©dias populacionais de dois grupos independentes
  - CondiÃ§Ãµes
    - Amostras independentes
    - Normalidade dos dados
    - Calculo depende se amostras tem variÃ¢ncias iguais
      - Maior s2 atÃ© 4x a menor s2, entÃ£o s12 = s22
    - Testar com teste F
      - $ğ¹=  \frac{(ğ‘ _1^2)}{(ğ‘ _2^2 )}$



::: {.absolute top="300" left="700"}
$$
t = \frac{X_2 - X_1}{\sqrt{s^2(\frac{1}{n_1}+\frac{1}{n_2})}}
$$
\

$$
t = \frac{X_2 - X_1}{\sqrt{(\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2})}}
$$

:::


## Testes de significÃ¢ncia para duas amostras


:::: {.columns}

::: {.column width="50%"}

- Teste t para duas amostras independentes
  - Teste F
    - Calcular a variÃ¢ncia de cada grupo
      - VariÃ¢ncia do grupo 1 $(ğ‘ _1^2)$
      - VariÃ¢ncia do grupo 2 $(ğ‘ _2^2)$
    - Calcular o valor de F
      - $F =  \frac{ğ‘šğ‘ğ‘–ğ‘œğ‘Ÿ  ğ‘ ^2}{ğ‘šğ‘’ğ‘›ğ‘œğ‘Ÿ ğ‘ ^2 }$
      - $ğ¹=  \frac{(ğ‘ _1^2)}{(ğ‘ _2^2 )}$
    - Comparar com Ftab
    - $g.l. \frac{ğ‘›âˆ’1 g.l. do numerador}{ğ‘›âˆ’1 g.Ã§. do denominador}$
    
:::

::: {.column width="50%"}


Se $F \ge F_{tab} - s_1^2 \ne s_2^2$

\

::: texto-07

```{r}

# Tabela F - Valores crÃ­ticos
# Nivel de significancia: 5%

# Graus de liberdade
gl_num <- 1:7     # numerador (colunas)
gl_den <- 1:10    # denominador (linhas)

# Criar tabela base
tabela_f <- data.frame(
  `gl_den` = gl_den
)

# Calcular valores criticos de F
for (gln in gl_num) {
  tabela_f[[as.character(gln)]] <- 
    qf(0.95, df1 = gln, df2 = gl_den)
}

# Arredondar (padrao de livro)
tabela_f[ , -1] <- round(tabela_f[ , -1], 2)

# Exibir tabela
knitr::kable(
  tabela_f,
  caption = "Tabela F â€“ Valores crÃ­ticos para Î± = 5%",
  col.names = c(
    "GL Den.",
    paste("GL Num.", gl_num)
  ),
  align = "c"
)


```

:::

:::

::::



## Testes de significÃ¢ncia para uma amostra

:::: {.columns}

::: {.column width="60%"}

- Teste t para duas amostras independentes
  - VariÃ¢ncias sÃ£o iguais
    - Temos $s_1^2$ e $s_2^2$
    - Calculamos a variÃ¢ncia ponderada
$$
 s^2=  \frac{(ğ‘›_1âˆ’1)ğ‘ _1^2+(ğ‘›_2âˆ’1)ğ‘ _2^2}{(ğ‘›_1+ ğ‘›_2  âˆ’2)}
$$

    - Calculamos o valor de t

\

$$
t = \frac{X_2 - X_1}{\sqrt{s^2(\frac{1}{n_1}+\frac{1}{n_2})}}
$$
:::

::: {.column width="40%"}

\
\
\
\
\
\
\
\
\

Se o valor absoluto de $t \ge t_{tab}$: mÃ©dias sÃ£o diferentes

:::

::::


## Testes de significÃ¢ncia para uma amostra

:::: {.columns}

::: {.column width="60%"}

- Teste t para duas amostras independentes
  - VariÃ¢ncias sÃ£o diferentes
    - Temos $s_1^2$ e $s_2^2$
    - Calculamos o valor de t
$$
t = \frac{X_2 - X_1}{\sqrt{(\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2})}}
$$
    
    - Calculamos g. l.

$$
g = \frac{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}{\frac{(\frac{s_1^2}{n_1})^2}{n_1-1}+\frac{(\frac{s_2^2}{n_2})^2}{n_2-1}}
$$
:::

::: {.column width="40%"}

\
\
\
\
\
\
\
\
\

Se o valor absoluto de $t \ge t_{tab}$: mÃ©dias sÃ£o diferentes

:::

::::
